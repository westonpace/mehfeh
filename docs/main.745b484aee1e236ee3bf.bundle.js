webpackJsonp([1],{0:function(t,e,n){t.exports=n("cDNt")},cDNt:function(t,e,n){"use strict";function r(t){return _._15(0,[],null,null)}function o(t){return _._15(0,[(t()(),_._3(0,null,null,1,"app-root",[],null,null,null,r,x)),_._1(4243456,null,0,y,[_.k,f,l],null,null)],null,null)}Object.defineProperty(e,"__esModule",{value:!0});var a={production:!0},i=function(){function t(){}return t}(),c=n("CPp0"),u=n("Dqrr"),l=(n.n(u),function(){function t(t){this.http=t,this._model=new u.ReplaySubject(1),this.fetchModel()}return Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),t.prototype.fetchModel=function(){var t=this;this.http.get("assets/model.json").subscribe(function(e){t._model.next(e.json())})},t.ctorParameters=function(){return[{type:c.d}]},t}()),s=n("CPp0"),p=n("Dqrr"),f=(n.n(p),function(){function t(t,e){var n=this;this.http=t,this.modelService=e,this._loaded=new p.BehaviorSubject(!1),this.iconFileMap={"Green Axe":"green-axe-20.png","Blue Lance":"blue-lance-20.png","Red Sword":"red-sword-20.png","Red Tome":"red-tome-20.png","Blue Tome":"blue-tome-20.png","Green Tome":"green-tome-20.png","Red Breath":"red-dragon-20.png","Blue Breath":"blue-dragon-20.png","Green Breath":"green-dragon-20.png","Neutral Staff":"staff-20.png","Neutral Bow":"archer-20.png","Neutral Dagger":"dagger-20.png",Cavalry:"cavalry-20.png",Armored:"armored-20.png",Flying:"flying-20.png",Infantry:"infantry-20.png"},this.iconDataMap={},this.faceDataMap={},this.fetchIcons().flatMap(function(){return console.log("Icons loaded"),e.model}).flatMap(function(t){return n.fetchFaces(t.heroList)}).subscribe(function(){console.log("Faces loaded"),n._loaded.next(!0)})}return Object.defineProperty(t.prototype,"loaded",{get:function(){return this._loaded},enumerable:!0,configurable:!0}),t.prototype.getFace=function(t){if(!this._loaded.value)throw Error("Icons service must be loaded first");return this.faceDataMap[t]},t.prototype.getIcon=function(t){if(!this._loaded.value)throw Error("Icons service must be loaded first");return t in this.iconDataMap||console.log("Could not find icon: "+t),this.iconDataMap[t]},t.prototype.fetchIcons=function(){for(var t=this,e=[],n=this,r=0,o=Object.keys(this.iconFileMap);r<o.length;r++){var a=o[r];!function(r){var o="assets/images/"+n.iconFileMap[r];e.push(n.http.get(o,{responseType:s.g.Blob}).do(function(e){t.iconDataMap[r]=window.URL.createObjectURL(e.blob())}))}(a)}return p.Observable.forkJoin(e)},t.prototype.getFaceName=function(t){return t.replace(/ /g,"-").replace(/\(/g,"").replace(/\)/g,"")},t.prototype.fetchFaces=function(t){for(var e=this,n=[],r=this,o=0,a=t;o<a.length;o++){var i=a[o];!function(t){var o="assets/images/faces/"+r.getFaceName(t.name)+".png";n.push(r.http.get(o,{responseType:s.g.Blob}).do(function(n){e.faceDataMap[t.name]=window.URL.createObjectURL(n.blob())}))}(i)}return p.Observable.forkJoin(n)},t.ctorParameters=function(){return[{type:s.d},{type:l}]},t}()),d=n("0z5Q"),h=(n.n(d),n("/oeL")),g="defense",m="resistance",y=function(){function t(t,e,n){this.hostRef=t,this.iconsService=e,this.modelService=n}return t.prototype.ngAfterViewInit=function(){var t=this;this.iconsService.loaded.subscribe(function(e){e&&t.modelService.model.subscribe(function(e){t.render(e)})})},t.prototype.reportIncorrectlyConfiguredHeroes=function(t){Object.keys(t.heroes).filter(function(e){return!t.heroes[e].levelFortyStats[5]}).forEach(function(t){console.log("Ignoring "+t)})},t.prototype.reportRanges=function(t){for(var e=0,n=["attack","defense","hp","speed","resistance"];e<n.length;e++){var r=n[e];!function(e){var n=Object.keys(t.heroes).map(function(n){return t.heroes[n].levelFortyStats[5][e]}),r=Math.min.apply(Math,n),o=Math.max.apply(Math,n);console.log(e+": "+r+" - "+o+" ("+(o-r)+")")}(r)}},t.prototype.calculateSize=function(t){var e=d.extent(t.map(function(t){return t.x})),n=d.extent(t.map(function(t){return t.y}));return{width:80*(e[1]-e[0]+1)+150,height:80*(n[1]-n[0]+1)+100}},t.prototype.calculateDupeNumber=function(t){for(var e=t,n={},r=0,o=e;r<o.length;r++){var a=o[r],i=a.x+"-"+a.y,c=n[i];a.dupeNumber=void 0!==c?c+1:0,4===a.dupeNumber&&console.log("ERR: Cannot fit: "+a.name),n[i]=a.dupeNumber}return e},t.prototype.getXRoot=function(t,e){return e(0===t.dupeNumber||2===t.dupeNumber?t.x-.5:t.x)},t.prototype.getYRoot=function(t,e){return e(0===t.dupeNumber||1===t.dupeNumber?t.y+.5:t.y)},t.prototype.render=function(t){var e=this;this.reportIncorrectlyConfiguredHeroes(t),this.reportRanges(t);var n=Object.keys(t.heroes).filter(function(e){return t.heroes[e].levelFortyStats[5]}).map(function(e){return{name:e,stats:t.heroes[e].levelFortyStats[5]}}).map(function(t){return{name:t.name,x:t.stats[g],y:t.stats[m]}}),r=this.calculateDupeNumber(n),o=this.calculateSize(r),a=d.select(this.hostRef.nativeElement).append("svg").attr("width",o.width).attr("height",o.height),i=a.append("g").attr("transform","translate(100, 0)"),c=d.extent(r,function(t){return t.x}),u=d.extent(r,function(t){return t.y}),l=d.scaleLinear().domain([c[0],c[1]+1]).range([0,o.width-150]),s=d.scaleLinear().domain([u[0],u[1]+1]).range([o.height-100,0]),p=(l(1),l(0),s(1),s(0),i.selectAll("image").data(r)),f=p.enter();f.append("image").merge(p).attr("x",function(t){return e.getXRoot(t,l)}).attr("y",function(t){return e.getYRoot(t,s)+20}).attr("width",20).attr("height",20).attr("title",function(t){return t.name}).attr("xlink:href",function(n){return e.iconsService.getIcon(t.heroes[n.name].weaponType)}),f.append("image").merge(p).attr("x",function(t){return e.getXRoot(t,l)+20}).attr("y",function(t){return e.getYRoot(t,s)+20}).attr("width",20).attr("height",20).attr("xlink:href",function(n){return e.iconsService.getIcon(t.heroes[n.name].movementType)}),f.append("image").merge(p).attr("x",function(t){return e.getXRoot(t,l)}).attr("y",function(t){return e.getYRoot(t,s)}).attr("width",40).attr("height",20).attr("preserveAspectRatio","xMinYMid slice").attr("xlink:href",function(t){return e.iconsService.getFace(t.name)});var h=c[1]-c[0],y=u[1]-u[0],b=Array.from(Array(h+2).keys()).map(function(t){return t+c[0]}),_=Array.from(Array(y+2).keys()).map(function(t){return t+u[0]}),v=i.append("g").attr("class","gridlines");v.selectAll("line.xgrid").data(b).enter().append("line").attr("class","xgrid").attr("x1",function(t){return l(t-.5)}).attr("y1",s(u[0]-.5)).attr("x2",function(t){return l(t-.5)}).attr("y2",s(u[1]+.5)).style("stroke","black").style("opacity",.25),v.selectAll("line.ygrid").data(_).enter().append("line").attr("class","ygrid").attr("x1",l(c[0]-.5)).attr("y1",function(t){return s(t-.5)}).attr("x2",l(c[1]+.5)).attr("y2",function(t){return s(t-.5)}).style("stroke","black").style("opacity",.25),a.append("g").attr("transform","translate(100,"+(o.height-60)+")").call(d.axisBottom(l)).append("text").attr("fill","#000").attr("transform","translate("+(50+(o.width-100)/2)+", 40)").text(g),a.append("g").attr("transform","translate(60, 0)").call(d.axisLeft(s)).append("text").attr("fill","#000").attr("transform","translate(-60, "+(50+(o.height-100)/2)+") rotate(-90)").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text(m)},t.ctorParameters=function(){return[{type:h.k},{type:f},{type:l}]},t}(),b=[""],_=n("/oeL"),v=[b],x=_._0({encapsulation:0,styles:v,data:{}}),w=_.Y("app-root",y,o,{},{},[]),R=n("/oeL"),k=n("qbdv"),M=n("fc+i"),F=n("CPp0"),j=R.Z(i,[y],function(t){return R._12([R._13(512,R.i,R.W,[[8,[w]],[3,R.i],R.x]),R._13(5120,R.v,R._11,[[3,R.v]]),R._13(4608,k.d,k.c,[R.v]),R._13(4608,R.h,R.h,[]),R._13(5120,R.a,R._4,[]),R._13(5120,R.t,R._9,[]),R._13(5120,R.u,R._10,[]),R._13(4608,M.b,M.s,[k.b]),R._13(6144,R.H,null,[M.b]),R._13(4608,M.e,M.f,[]),R._13(5120,M.c,function(t,e,n,r){return[new M.k(t),new M.o(e),new M.n(n,r)]},[k.b,k.b,k.b,M.e]),R._13(4608,M.d,M.d,[M.c,R.z]),R._13(135680,M.m,M.m,[k.b]),R._13(4608,M.l,M.l,[M.d,M.m]),R._13(6144,R.F,null,[M.l]),R._13(6144,M.p,null,[M.m]),R._13(4608,R.L,R.L,[R.z]),R._13(4608,M.g,M.g,[k.b]),R._13(4608,M.i,M.i,[k.b]),R._13(4608,F.c,F.c,[]),R._13(4608,F.h,F.b,[]),R._13(5120,F.j,F.k,[]),R._13(4608,F.i,F.i,[F.c,F.h,F.j]),R._13(4608,F.f,F.a,[]),R._13(5120,F.d,F.l,[F.i,F.f]),R._13(4608,l,l,[F.d]),R._13(4608,f,f,[F.d,l]),R._13(512,k.a,k.a,[]),R._13(1024,R.l,M.q,[]),R._13(1024,R.b,function(t,e){return[M.r(t,e)]},[[2,M.h],[2,R.y]]),R._13(512,R.c,R.c,[[2,R.b]]),R._13(131584,R._2,R._2,[R.z,R.X,R.r,R.l,R.i,R.c]),R._13(2048,R.e,null,[R._2]),R._13(512,R.d,R.d,[R.e]),R._13(512,M.a,M.a,[[3,M.a]]),R._13(512,F.e,F.e,[]),R._13(512,i,i,[])])}),S=n("/oeL"),N=n("fc+i");a.production&&Object(S.R)(),Object(N.j)().bootstrapModuleFactory(j)},gFIY:function(t,e){function n(t){return new Promise(function(e,n){n(new Error("Cannot find module '"+t+"'."))})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="gFIY"}},[0]);